{"version":3,"sources":["stNetwork/comSYS_Morse/csysMorse_Services.js"],"names":[],"mappings":"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","file":"stNetwork/comSYS_Morse/csysMorse_Services.js","sourcesContent":["\"use strict\";\r\n\r\n/**\r\n * COMSystem library\r\n * \r\n * Provides communications system to ST network\r\n * \r\n * \r\n * v. Morse\r\n */\r\n\r\n\r\n\r\n/**\r\n * Bind Service\r\n */\r\nclass TBind_Morse_Service {\r\n\t\r\n\tconstructor(comSYS, tBind) {\r\n\t\t\r\n\t\tthis.comSYS = comSYS;\r\n\t\tthis.tBind = tBind;\r\n\t\tthis.CONSTANTS = comSYS.CONSTANTS;\r\n\t}\r\n\t\r\n\t\r\n\tinitialize() {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\tservice.mapControlEvents();\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Map control events\r\n\t */\r\n\tmapControlEvents() {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\tlet tBind = service.tBind;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\t// Map event Unbind\r\n\t\ttBind.eventEmitter.on(tBind.CONSTANTS.Events.Unbind, service._event_Unbind);\r\n\t\t\r\n\t\t// Map event Bind_Started\r\n\t\ttBind.eventEmitter.on(tBind.CONSTANTS.Events.Bind_Started, service._event_Bind_Started);\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Bind_Started\r\n\t */\r\n\t_event_Bind_Started(data) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\tlet tBind = service.tBind;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\tlet synchro = data.synchro;\r\n\t\tlet options = data.options;\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Unbind\r\n\t */\r\n\t_event_Unbind(data) {\t\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n\r\n/**\r\n * Bind Service\r\n * Role Node\r\n */\r\nclass TBind_Morse_Srv_Node extends TBind_Morse_Service {\r\n\t\r\n\tconstructor(comSYS, tBind) {\r\n\t\t\r\n\t\tsuper(comSYS, tBind);\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Unbind\r\n\t */\r\n\t_event_Unbind(data) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\tlet tBind = service.tBind;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\tlet synchro = data.synchro;\r\n\t\tlet options = data.options;\r\n\t\t\r\n\t\t\r\n\t\tif (synchro) {\r\n\t\t\t\r\n\t\t\t// Send Message BindFree\r\n\t\t\tsocket.emit(comSYS.CONSTANTS.Messages.BindFree, \r\n\t\t\t\t{\r\n\t\t\t\t\t\"bindID\" : tBind.bindID,\r\n\t\t\t\t\t\"type\" : tBind.type\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n}\r\n\r\n\r\n/**\r\n * Bind Service\r\n * Role Server\r\n */\r\nclass TBind_Morse_Srv_Server extends TBind_Morse_Service {\r\n\t\r\n\tconstructor(comSYS, tBind) {\r\n\t\t\r\n\t\tsuper(comSYS, tBind);\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Unbind\r\n\t */\r\n\t_event_Unbind(data) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\tlet tBind = service.tBind;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\tlet synchro = data.synchro;\r\n\t\tlet options = data.options;\r\n\t\t\r\n\t\tif (synchro) {\r\n\t\t\t\r\n\t\t\t// Send Message UnBind\r\n\t\t\tsocket.emit(comSYS.CONSTANTS.Messages.UnBind, \r\n\t\t\t\t{\r\n\t\t\t\t\t\"bindID\" : options.bindID\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n}\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Communications System Service\r\n */\r\nclass COMSys_Morse_Service {\r\n\t\r\n\tconstructor(comSYS) {\r\n\t\t\r\n\t\tthis.comSYS = comSYS;\r\n\t\tthis.CONSTANTS = comSYS.CONSTANTS;\r\n\t}\r\n\t\r\n\t\r\n\tinitialize() {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\tservice.mapControlEvents();\r\n\t\tservice.mapControlMessages();\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Map control events\r\n\t */\r\n\tmapControlEvents(socket) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\t\r\n\t\tif (socket == undefined) {\r\n\t\t\tsocket = _config.controlChannel.socket;\r\n\t\t}\r\n\t\t\r\n\t\t// Map event Bind_Added\r\n\t\tcomSYS.eventEmitter.on(comSYS.CONSTANTS.Events.Bind_Added, service._event_Bind_Added);\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Map control messages\r\n\t */\r\n\tmapControlMessages() {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tif (socket == undefined) {\r\n\t\t\tsocket = _config.controlChannel.socket;\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t// Map message getBindList\r\n\t\tsocket.on(comSYS.CONSTANTS.Messages.getBindList, function(msg){\r\n\t\t\tservice._msg_getBindList(msg, socket, {\r\n\t\t\t\t\"filter\" : msg.filter\r\n\t\t\t});\r\n\t\t  });\r\n\t\t\r\n\t\t\r\n\t\t// Map message ErrorInfo\r\n\t\tsocket.on(comSYS.CONSTANTS.Messages.ErrorInfo, function(msg){\r\n\t\t\tservice._msg_ErrorInfo(msg, socket, {\r\n\t\t\t\t\"msgError\" : msg\r\n\t\t\t});\r\n\t\t  });\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Send ErrorInfo message\r\n\t */\r\n\tsendErrorInfo(socket, context, msg, data) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n//\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\t\t\r\n\t\tlet message = {\r\n\t\t\t\"context\" : context,\r\n\t\t\t\"msg\": msg,\r\n\t\t\t\"data\": data\r\n\t\t}\r\n\t\t\r\n\t\tsocket.emit(service.CONSTANTS.Messages.ErrorInfo, message);\t// Emit message BindList\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Bind_Added\r\n\t */\r\n\t_event_Bind_Added(data) {\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Message ErrorInfo\r\n\t */\r\n\t_msg_ErrorInfo(msg, socket, options) {\r\n\t\t\r\n\t\tconsole.log('<*> ST COMSys_Morse_Service._msg_ErrorInfo');\t// TODO REMOVE DEBUG LOG\r\n\t\tconsole.log(msg);\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Message getBindList\r\n\t */\r\n\t_msg_getBindList(msg, socket, options) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tconsole.log('<*> ST COMSys_Morse_Service._msg_getBindList');\t// TODO REMOVE DEBUG LOG\r\n\t\t\r\n\t\tlet message = {\r\n\t\t\t\"bindsList\": [],\r\n\t\t\t\"binds\" : comSYS.thingsBindings.length\r\n\t\t}\r\n\t\t\r\n\t\tcomSYS.thingsBindings.forEach(function(_bind, _i) {\r\n\t\t\t\r\n\t\t\tlet bindInfo = {\r\n\t\t\t\t\"bindID\" : \t_bind.bindID,\r\n\t\t\t\t\"type\" : _bind.type,\r\n\t\t\t\t\"state\" : _bind.state\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tmessage.bindsList.push(bindInfo);\r\n\t\t});\r\n\t\t\r\n\t\tsocket.emit(service.CONSTANTS.Messages.BindList, message);\t// Emit message BindList\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n\r\n/**\r\n * Communications System Service\r\n * Role Node\r\n */\r\nclass COMSys_Morse_Srv_Node extends COMSys_Morse_Service {\r\n\t\r\n\tconstructor(comSYS) {\r\n\t\t\r\n\t\tsuper(comSYS);\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Map control messages\r\n\t */\r\n\tmapControlMessages(socket) {\r\n\t\t\r\n\t\tsuper.mapControlMessages(socket);\r\n\t\t\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tif (socket == undefined) {\r\n\t\t\tsocket = _config.controlChannel.socket;\r\n\t\t}\r\n\r\n\t\t\r\n\t\t// Map message createBind\r\n\t\tsocket.on(comSYS.CONSTANTS.Messages.createBind, function(msg){\r\n\t\t\tservice._msg_createBind(msg, socket, {\r\n\t\t\t\t\"bindID\" : msg.bindID,\r\n\t\t\t\t\"type\" : msg.type,\r\n\t\t\t\t\"source\" :  msg.source,\r\n\t\t\t\t\"target\" :  msg.target\r\n\t\t\t\t\r\n\t\t\t});\r\n\t\t  });\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Bind_Added\r\n\t */\r\n\t_event_Bind_Added(data) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\tlet synchro = data.synchro;\r\n\t\tlet bind = data.bind;\r\n\t\tlet options = data.options;\r\n\t\t\r\n\t\t\r\n\t\tif (synchro) {\r\n\t\t\t\r\n\t\t\t// Send Message Bind_Created\r\n\t\t\tsocket.emit(comSYS.CONSTANTS.Messages.Bind_Created, \r\n\t\t\t\t{\r\n\t\t\t\t\t\"bindID\" : bind.bindID,\r\n\t\t\t\t\t\"type\" : bind.type\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Message createBind\r\n\t */\r\n\t_msg_createBind(msg, socket, options) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet type = options.type;\r\n\t\tlet source = options.source;\r\n\t\tlet target = options.target;\r\n\t\tlet _options = {\r\n\t\t\t\"bindID\" : options.bindID\r\n\t\t};\r\n\r\n\t\tconsole.log('<*> ST COMSys_Morse_Service._msg_createBind');\t// TODO REMOVE DEBUG LOG\r\n\r\n\t\tlet tbind = new TBind_Morse(type, source, target, _options);\r\n\t\t\r\n\t\ttry {\r\n\t\t\ttbind.initialize();\r\n\t\t\tcomSYS.addBind(tbind);\r\n\t\t} catch (e) {\r\n\t\t\tconsole.log('<EEE> ST COMSys_Morse_Service._msg_createBind');\t// TODO REMOVE DEBUG LOG\r\n\t\t\tconsole.log(e);\t// TODO REMOVE DEBUG LOG\r\n\t\t\t\r\n\t\t\t// Notify Error\r\n\t\t\tservice.sendErrorInfo( socket, \"Net.Bind\", e, \r\n\t\t\t\t{ \r\n\t\t\t\t\t\"controlMSG\": comSYS.CONSTANTS.Messages.createBind, \r\n\t\t\t\t\t\"msg\": msg, \r\n\t\t\t\t\t\"options\": options \r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n\r\n/**\r\n * Communications System Service\r\n * Role Server\r\n */\r\nclass COMSys_Morse_Srv_Server extends COMSys_Morse_Service {\r\n\t\r\n\tconstructor(comSYS) {\r\n\t\t\r\n\t\tsuper(comSYS);\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Map control messages\r\n\t */\r\n\tmapControlMessages(socket) {\r\n\t\t\r\n\t\tsuper.mapControlMessages(socket);\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Bind_Added\r\n\t */\r\n\t_event_Bind_Added(data) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\tlet synchro = data.synchro;\r\n\t\tlet bind = data.bind;\r\n\t\tlet options = data.options;\r\n\t\t\r\n\t\tif (synchro) {\r\n\t\t\t\r\n\t\t\t// Send Message createBind\r\n\t\t\tsocket.emit(comSYS.CONSTANTS.Messages.createBind, \r\n\t\t\t\t{\r\n\t\t\t\t\t\"bindID\" : options.bindID,\r\n\t\t\t\t\t\"type\" : options.type,\r\n\t\t\t\t\t\"source\" : options.source,\r\n\t\t\t\t\t\"target\" : options.target\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n\r\nlet cysMorseSrv_Lib = {\r\n\t\"TBind_Morse_Service\" : TBind_Morse_Service,\r\n\t\"TBind_Morse_Srv_Node\" : TBind_Morse_Srv_Node,\r\n\t\"TBind_Morse_Srv_Server\" : TBind_Morse_Srv_Server,\r\n\t\"COMSys_Morse_Service\" : COMSys_Morse_Service,\r\n\t\"COMSys_Morse_Srv_Node\" : COMSys_Morse_Srv_Node,\r\n\t\"COMSys_Morse_Srv_Server\" : COMSys_Morse_Srv_Server\r\n}\r\n\r\n\r\nmodule.exports = cysMorseSrv_Lib;\r\n\r\n"],"sourceRoot":"C:\\Users\\Felipe\\Documents\\Work\\SomeThings\\dev\\NLVL_STServer\\es6"}